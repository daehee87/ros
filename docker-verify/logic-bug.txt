vi PX4-Autopilot/src/modules/mavlink/mavlink_ftp.cpp


bool MavlinkFTP::_validatePathIsWritable(const char *path)
{
#ifdef __PX4_NUTTX

        // Don't allow writes to system paths as they are in RAM
        // Ideally we'd canonicalize the path (with 'realpath'), but it might not exist, so realpath() would fail.
        // The next simpler thing is to check there's no reference to a parent dir.
        if (strncmp(path, "/fs/microsd/", 12) != 0 || strstr(path, "/../") != nullptr) {
                PX4_ERR("Disallowing write to %s", path);
                return false;
        }

#endif
        return true;
}

